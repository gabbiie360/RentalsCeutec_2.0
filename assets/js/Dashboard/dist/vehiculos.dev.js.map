{"version":3,"sources":["vehiculos.js"],"names":["vehiculosRef","db","cargarVehiculos","tabla","document","getElementById","innerHTML","snapshot","marcaFiltro","value","toLowerCase","dispoFiltro","anioFiltro","precioMin","parseFloat","precioMax","forEach","docu","data","cumpleMarca","MARCA","includes","cumpleDispo","DISPONIBLE","toString","cumpleAnio","AÑO","cumplePrecio","PRECIO_DIA","MODELO","PLACA","toFixed","id","eliminarVehiculo","confirm","abrirModalVehiculo","querySelectorAll","e","bootstrap","Modal","show","editarVehiculo","getDoc","docSnap","exists","ASIENTOS","COMBUSTIBLE","TRANSMISION","guardarVehiculo","campos","valor","trim","vehiculo","parseInt","updatedAt","Date","createdAt","getInstance","hide"],"mappings":"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","sourcesContent":["import { db } from \"./asset/js/firebaseConfig.js\";\r\nimport { collection, doc, addDoc, updateDoc, deleteDoc, onSnapshot, getDocs, query, where } from \"https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js\";\r\nimport { mostrarToast } from \"./asset/js/toast.js\";\r\n\r\nconst vehiculosRef = collection(db, \"vehiculos\");\r\n\r\nexport function cargarVehiculos() {\r\n  const tabla = document.getElementById(\"tablaVehiculos\");\r\n  tabla.innerHTML = \"\";\r\n\r\n  onSnapshot(vehiculosRef, (snapshot) => {\r\n    tabla.innerHTML = \"\";\r\n\r\n    const marcaFiltro = document.getElementById(\"filtroMarca\").value.toLowerCase();\r\n    const dispoFiltro = document.getElementById(\"filtroDisponibilidad\").value;\r\n    const anioFiltro = document.getElementById(\"filtroAnio\").value;\r\n    const precioMin = parseFloat(document.getElementById(\"precioMin\").value);\r\n    const precioMax = parseFloat(document.getElementById(\"precioMax\").value);\r\n\r\n    snapshot.forEach((docu) => {\r\n      const data = docu.data();\r\n\r\n      const cumpleMarca = !marcaFiltro || data.MARCA.toLowerCase().includes(marcaFiltro);\r\n      const cumpleDispo = dispoFiltro === \"\" || data.DISPONIBLE.toString() === dispoFiltro;\r\n      const cumpleAnio = !anioFiltro || data.AÑO.toString() === anioFiltro;\r\n      const cumplePrecio = (!precioMin || data.PRECIO_DIA >= precioMin) &&\r\n                           (!precioMax || data.PRECIO_DIA <= precioMax);\r\n\r\n      if (cumpleMarca && cumpleDispo && cumpleAnio && cumplePrecio) {\r\n        tabla.innerHTML += `\r\n        <tr>\r\n          <td>${data.MARCA}</td>\r\n          <td>${data.MODELO}</td>\r\n          <td>${data.PLACA}</td>\r\n          <td>${data.AÑO}</td>\r\n          <td>L. ${data.PRECIO_DIA.toFixed(2)}</td>\r\n          <td><span class=\"badge ${data.DISPONIBLE ? 'bg-success' : 'bg-danger'}\">${data.DISPONIBLE ? 'Disponible' : 'No disponible'}</span></td>\r\n          <td>\r\n            <button class=\"btn btn-sm btn-secondary\" onclick=\"editarVehiculo('${docu.id}')\"><i class=\"fa fa-pen\"></i></button>\r\n            <button class=\"btn btn-sm btn-danger\" onclick=\"eliminarVehiculo('${docu.id}')\"><i class=\"fa fa-trash\"></i></button>\r\n          </td>\r\n        </tr>\r\n        `;\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nexport async function eliminarVehiculo(id) {\r\n  if (confirm(\"¿Seguro que deseas eliminar este vehículo?\")) {\r\n    try {\r\n      await deleteDoc(doc(db, \"vehiculos\", id));\r\n      mostrarToast(\"Vehículo eliminado correctamente.\");\r\n    } catch (error) {\r\n      mostrarToast(\"No se pudo eliminar.\");\r\n    }\r\n  }\r\n}\r\n// Abrir modal para agregar o editar un vehículo\r\nexport function abrirModalVehiculo() {\r\n    document.querySelectorAll(\"#modalVehiculo input, #modalVehiculo select\").forEach((e) => (e.value = \"\"));\r\n    document.getElementById(\"disponible\").value = \"true\";\r\n    new bootstrap.Modal(document.getElementById(\"modalVehiculo\")).show();\r\n  }\r\n  \r\n  // Editar un vehículo existente\r\n  export async function editarVehiculo(id) {\r\n    const docSnap = await getDoc(doc(db, \"vehiculos\", id));\r\n    if (docSnap.exists()) {\r\n      const data = docSnap.data();\r\n      document.getElementById(\"vehiculoId\").value = id;\r\n      document.getElementById(\"marca\").value = data.MARCA;\r\n      document.getElementById(\"modelo\").value = data.MODELO;\r\n      document.getElementById(\"placa\").value = data.PLACA;\r\n      document.getElementById(\"anio\").value = data.AÑO;\r\n      document.getElementById(\"asientos\").value = data.ASIENTOS;\r\n      document.getElementById(\"combustible\").value = data.COMBUSTIBLE;\r\n      document.getElementById(\"transmision\").value = data.TRANSMISION;\r\n      document.getElementById(\"precioDia\").value = data.PRECIO_DIA;\r\n      document.getElementById(\"disponible\").value = data.DISPONIBLE ? \"true\" : \"false\";\r\n      new bootstrap.Modal(document.getElementById(\"modalVehiculo\")).show();\r\n    }\r\n  }\r\n  \r\n  // Guardar un nuevo vehículo o actualizar uno existente\r\n  export async function guardarVehiculo() {\r\n    const campos = [\"marca\", \"modelo\", \"placa\", \"anio\", \"asientos\", \"combustible\", \"transmision\", \"precioDia\"];\r\n    for (let id of campos) {\r\n      const valor = document.getElementById(id).value.trim();\r\n      if (!valor) return mostrarToast(\"Todos los campos del vehículo son obligatorios.\", \"danger\");\r\n    }\r\n  \r\n    const vehiculo = {\r\n      MARCA: document.getElementById(\"marca\").value.trim(),\r\n      MODELO: document.getElementById(\"modelo\").value.trim(),\r\n      PLACA: document.getElementById(\"placa\").value.trim(),\r\n      AÑO: parseInt(document.getElementById(\"anio\").value),\r\n      ASIENTOS: parseInt(document.getElementById(\"asientos\").value),\r\n      COMBUSTIBLE: document.getElementById(\"combustible\").value.trim(),\r\n      TRANSMISION: document.getElementById(\"transmision\").value.trim(),\r\n      PRECIO_DIA: parseFloat(document.getElementById(\"precioDia\").value),\r\n      DISPONIBLE: document.getElementById(\"disponible\").value === \"true\",\r\n      updatedAt: new Date(),\r\n    };\r\n  \r\n    const id = document.getElementById(\"vehiculoId\").value;\r\n    try {\r\n      if (id) {\r\n        // Actualizar vehículo existente\r\n        await updateDoc(doc(db, \"vehiculos\", id), vehiculo);\r\n        mostrarToast(\"Vehículo actualizado correctamente.\", \"success\");\r\n      } else {\r\n        // Agregar nuevo vehículo\r\n        vehiculo.createdAt = new Date();\r\n        await addDoc(vehiculosRef, vehiculo);\r\n        mostrarToast(\"Vehículo agregado correctamente.\", \"success\");\r\n      }\r\n      bootstrap.Modal.getInstance(document.getElementById(\"modalVehiculo\")).hide();\r\n    } catch (error) {\r\n      mostrarToast(\"Error al guardar el vehículo.\", \"danger\");\r\n    }\r\n  }"],"file":"vehiculos.dev.js"}