"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cargarUsuarios=cargarUsuarios,exports.eliminarUsuario=eliminarUsuario;var _firebaseConfig=require("./asset/js/firebaseConfig.js"),_firebaseFirestore=require("https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js"),_toast=require("./asset/js/toast.js"),usuariosRef=(0,_firebaseFirestore.collection)(_firebaseConfig.db,"usuarios");function cargarUsuarios(){var n=document.getElementById("tablaUsuarios");n.innerHTML="";var i=document.getElementById("filtroUsuarioCorreo").value.toLowerCase(),c=document.getElementById("filtroRol").value;(0,_firebaseFirestore.onSnapshot)(usuariosRef,function(e){n.innerHTML="",e.forEach(function(e){var r=e.data(),t=e.id,a=r.email||"",s=r.rol||"user";if(a.trim()&&(a.toLowerCase().includes(i)&&(!c||s===c))){var o=document.createElement("tr");o.innerHTML="\n          <td>".concat(a,'</td>\n          <td>\n            <select class="form-select form-select-sm" data-uid="').concat(t,'">\n              <option value="user" ').concat("user"===s?"selected":"",'>Usuario</option>\n              <option value="admin" ').concat("admin"===s?"selected":"",'>Administrador</option>\n            </select>\n          </td>\n          <td>\n            <button class="btn btn-sm btn-danger" onclick="eliminarUsuario(\'').concat(t,'\')">\n              <i class="fa fa-trash"></i>\n            </button>\n          </td>\n        '),n.appendChild(o)}}),document.querySelectorAll("select[data-uid]").forEach(function(e){e.addEventListener("change",function(){var r,t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.value,t=this.dataset.uid,e.prev=2,e.next=5,regeneratorRuntime.awrap((0,_firebaseFirestore.updateDoc)((0,_firebaseFirestore.doc)(_firebaseConfig.db,"usuarios",t),{rol:r}));case 5:(0,_toast.mostrarToast)("Rol actualizado correctamente.","success"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),(0,_toast.mostrarToast)("Error al actualizar el rol.","danger");case 11:case"end":return e.stop()}},null,this,[[2,8]])})})})}function eliminarUsuario(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("Â¿Seguro que quieres eliminar este usuario?"))return e.prev=1,e.next=4,regeneratorRuntime.awrap((0,_firebaseFirestore.deleteDoc)((0,_firebaseFirestore.doc)(_firebaseConfig.db,"usuarios",r)));e.next=10;break;case 4:(0,_toast.mostrarToast)("Usuario eliminado correctamente."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),(0,_toast.mostrarToast)("No se pudo eliminar el usuario.");case 10:case"end":return e.stop()}},null,null,[[1,7]])}
//# sourceMappingURL=usuarios.min.js.map
