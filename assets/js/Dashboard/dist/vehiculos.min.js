"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cargarVehiculos=cargarVehiculos,exports.eliminarVehiculo=eliminarVehiculo,exports.abrirModalVehiculo=abrirModalVehiculo,exports.editarVehiculo=editarVehiculo,exports.guardarVehiculo=guardarVehiculo;var _firebaseConfig=require("./asset/js/firebaseConfig.js"),_firebaseFirestore=require("https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js"),_toast=require("./asset/js/toast.js"),vehiculosRef=(0,_firebaseFirestore.collection)(_firebaseConfig.db,"vehiculos");function cargarVehiculos(){var d=document.getElementById("tablaVehiculos");d.innerHTML="",(0,_firebaseFirestore.onSnapshot)(vehiculosRef,function(e){d.innerHTML="";var c=document.getElementById("filtroMarca").value.toLowerCase(),i=document.getElementById("filtroDisponibilidad").value,s=document.getElementById("filtroAnio").value,l=parseFloat(document.getElementById("precioMin").value),u=parseFloat(document.getElementById("precioMax").value);e.forEach(function(e){var t=e.data(),a=!c||t.MARCA.toLowerCase().includes(c),o=""===i||t.DISPONIBLE.toString()===i,n=!s||t.AÑO.toString()===s,r=(!l||t.PRECIO_DIA>=l)&&(!u||t.PRECIO_DIA<=u);a&&o&&n&&r&&(d.innerHTML+="\n        <tr>\n          <td>".concat(t.MARCA,"</td>\n          <td>").concat(t.MODELO,"</td>\n          <td>").concat(t.PLACA,"</td>\n          <td>").concat(t.AÑO,"</td>\n          <td>L. ").concat(t.PRECIO_DIA.toFixed(2),'</td>\n          <td><span class="badge ').concat(t.DISPONIBLE?"bg-success":"bg-danger",'">').concat(t.DISPONIBLE?"Disponible":"No disponible",'</span></td>\n          <td>\n            <button class="btn btn-sm btn-secondary" onclick="editarVehiculo(\'').concat(e.id,'\')"><i class="fa fa-pen"></i></button>\n            <button class="btn btn-sm btn-danger" onclick="eliminarVehiculo(\'').concat(e.id,'\')"><i class="fa fa-trash"></i></button>\n          </td>\n        </tr>\n        '))})})}function eliminarVehiculo(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("¿Seguro que deseas eliminar este vehículo?"))return e.prev=1,e.next=4,regeneratorRuntime.awrap((0,_firebaseFirestore.deleteDoc)((0,_firebaseFirestore.doc)(_firebaseConfig.db,"vehiculos",t)));e.next=10;break;case 4:(0,_toast.mostrarToast)("Vehículo eliminado correctamente."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),(0,_toast.mostrarToast)("No se pudo eliminar.");case 10:case"end":return e.stop()}},null,null,[[1,7]])}function abrirModalVehiculo(){document.querySelectorAll("#modalVehiculo input, #modalVehiculo select").forEach(function(e){return e.value=""}),document.getElementById("disponible").value="true",new bootstrap.Modal(document.getElementById("modalVehiculo")).show()}function editarVehiculo(t){var a,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(getDoc((0,_firebaseFirestore.doc)(_firebaseConfig.db,"vehiculos",t)));case 2:(a=e.sent).exists()&&(o=a.data(),document.getElementById("vehiculoId").value=t,document.getElementById("marca").value=o.MARCA,document.getElementById("modelo").value=o.MODELO,document.getElementById("placa").value=o.PLACA,document.getElementById("anio").value=o.AÑO,document.getElementById("asientos").value=o.ASIENTOS,document.getElementById("combustible").value=o.COMBUSTIBLE,document.getElementById("transmision").value=o.TRANSMISION,document.getElementById("precioDia").value=o.PRECIO_DIA,document.getElementById("disponible").value=o.DISPONIBLE?"true":"false",new bootstrap.Modal(document.getElementById("modalVehiculo")).show());case 4:case"end":return e.stop()}})}function guardarVehiculo(){var t,a,o,n,r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:t=0,a=["marca","modelo","placa","anio","asientos","combustible","transmision","precioDia"];case 2:if(!(t<a.length)){e.next=10;break}if(o=a[t],document.getElementById(o).value.trim()){e.next=7;break}return e.abrupt("return",(0,_toast.mostrarToast)("Todos los campos del vehículo son obligatorios.","danger"));case 7:t++,e.next=2;break;case 10:if(n={MARCA:document.getElementById("marca").value.trim(),MODELO:document.getElementById("modelo").value.trim(),PLACA:document.getElementById("placa").value.trim(),"AÑO":parseInt(document.getElementById("anio").value),ASIENTOS:parseInt(document.getElementById("asientos").value),COMBUSTIBLE:document.getElementById("combustible").value.trim(),TRANSMISION:document.getElementById("transmision").value.trim(),PRECIO_DIA:parseFloat(document.getElementById("precioDia").value),DISPONIBLE:"true"===document.getElementById("disponible").value,updatedAt:new Date},r=document.getElementById("vehiculoId").value,e.prev=12,r)return e.next=16,regeneratorRuntime.awrap((0,_firebaseFirestore.updateDoc)((0,_firebaseFirestore.doc)(_firebaseConfig.db,"vehiculos",r),n));e.next=19;break;case 16:(0,_toast.mostrarToast)("Vehículo actualizado correctamente.","success"),e.next=23;break;case 19:return n.createdAt=new Date,e.next=22,regeneratorRuntime.awrap((0,_firebaseFirestore.addDoc)(vehiculosRef,n));case 22:(0,_toast.mostrarToast)("Vehículo agregado correctamente.","success");case 23:bootstrap.Modal.getInstance(document.getElementById("modalVehiculo")).hide(),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),(0,_toast.mostrarToast)("Error al guardar el vehículo.","danger");case 29:case"end":return e.stop()}},null,null,[[12,26]])}
//# sourceMappingURL=vehiculos.min.js.map
