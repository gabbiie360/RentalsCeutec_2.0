{"version":3,"sources":["vehiculos.js"],"names":["_firebaseConfig","require","_firebaseFirestore","_toast","vehiculosRef","collection","db","cargarVehiculos","tabla","document","getElementById","innerHTML","onSnapshot","snapshot","marcaFiltro","value","toLowerCase","dispoFiltro","anioFiltro","precioMin","parseFloat","data","cumpleMarca","DISPONIBLE","toString","AÑO","PRECIO_DIA","precioMax","cumplePrecio","forEach","MARCA","cumpleDispo","MODELO","cumpleAnio","PLACA","toFixed","docu","id","eliminarVehiculo","regeneratorRuntime","async","_context","prev","next","confirm","awrap","deleteDoc","doc","mostrarToast","t0","stop","abrirModalVehiculo","querySelectorAll","e","bootstrap","Modal","show","editarVehiculo","docSnap","_context2","getDoc","sent","exists","ASIENTOS","COMBUSTIBLE","TRANSMISION","trim","vehiculo","parseInt","updateDoc","createdAt","Date","addDoc","getInstance","hide"],"mappings":"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","file":"vehiculos.min.js","sourcesContent":["import { db } from \"./asset/js/firebaseConfig.js\";\r\nimport { collection, doc, addDoc, updateDoc, deleteDoc, onSnapshot, getDocs, query, where } from \"https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js\";\r\nimport { mostrarToast } from \"./asset/js/toast.js\";\r\n\r\nconst vehiculosRef = collection(db, \"vehiculos\");\r\n\r\nexport function cargarVehiculos() {\r\n  const tabla = document.getElementById(\"tablaVehiculos\");\r\n  tabla.innerHTML = \"\";\r\n\r\n  onSnapshot(vehiculosRef, (snapshot) => {\r\n    tabla.innerHTML = \"\";\r\n\r\n    const marcaFiltro = document.getElementById(\"filtroMarca\").value.toLowerCase();\r\n    const dispoFiltro = document.getElementById(\"filtroDisponibilidad\").value;\r\n    const anioFiltro = document.getElementById(\"filtroAnio\").value;\r\n    const precioMin = parseFloat(document.getElementById(\"precioMin\").value);\r\n    const precioMax = parseFloat(document.getElementById(\"precioMax\").value);\r\n\r\n    snapshot.forEach((docu) => {\r\n      const data = docu.data();\r\n\r\n      const cumpleMarca = !marcaFiltro || data.MARCA.toLowerCase().includes(marcaFiltro);\r\n      const cumpleDispo = dispoFiltro === \"\" || data.DISPONIBLE.toString() === dispoFiltro;\r\n      const cumpleAnio = !anioFiltro || data.AÑO.toString() === anioFiltro;\r\n      const cumplePrecio = (!precioMin || data.PRECIO_DIA >= precioMin) &&\r\n                           (!precioMax || data.PRECIO_DIA <= precioMax);\r\n\r\n      if (cumpleMarca && cumpleDispo && cumpleAnio && cumplePrecio) {\r\n        tabla.innerHTML += `\r\n        <tr>\r\n          <td>${data.MARCA}</td>\r\n          <td>${data.MODELO}</td>\r\n          <td>${data.PLACA}</td>\r\n          <td>${data.AÑO}</td>\r\n          <td>L. ${data.PRECIO_DIA.toFixed(2)}</td>\r\n          <td><span class=\"badge ${data.DISPONIBLE ? 'bg-success' : 'bg-danger'}\">${data.DISPONIBLE ? 'Disponible' : 'No disponible'}</span></td>\r\n          <td>\r\n            <button class=\"btn btn-sm btn-secondary\" onclick=\"editarVehiculo('${docu.id}')\"><i class=\"fa fa-pen\"></i></button>\r\n            <button class=\"btn btn-sm btn-danger\" onclick=\"eliminarVehiculo('${docu.id}')\"><i class=\"fa fa-trash\"></i></button>\r\n          </td>\r\n        </tr>\r\n        `;\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nexport async function eliminarVehiculo(id) {\r\n  if (confirm(\"¿Seguro que deseas eliminar este vehículo?\")) {\r\n    try {\r\n      await deleteDoc(doc(db, \"vehiculos\", id));\r\n      mostrarToast(\"Vehículo eliminado correctamente.\");\r\n    } catch (error) {\r\n      mostrarToast(\"No se pudo eliminar.\");\r\n    }\r\n  }\r\n}\r\n// Abrir modal para agregar o editar un vehículo\r\nexport function abrirModalVehiculo() {\r\n    document.querySelectorAll(\"#modalVehiculo input, #modalVehiculo select\").forEach((e) => (e.value = \"\"));\r\n    document.getElementById(\"disponible\").value = \"true\";\r\n    new bootstrap.Modal(document.getElementById(\"modalVehiculo\")).show();\r\n  }\r\n  \r\n  // Editar un vehículo existente\r\n  export async function editarVehiculo(id) {\r\n    const docSnap = await getDoc(doc(db, \"vehiculos\", id));\r\n    if (docSnap.exists()) {\r\n      const data = docSnap.data();\r\n      document.getElementById(\"vehiculoId\").value = id;\r\n      document.getElementById(\"marca\").value = data.MARCA;\r\n      document.getElementById(\"modelo\").value = data.MODELO;\r\n      document.getElementById(\"placa\").value = data.PLACA;\r\n      document.getElementById(\"anio\").value = data.AÑO;\r\n      document.getElementById(\"asientos\").value = data.ASIENTOS;\r\n      document.getElementById(\"combustible\").value = data.COMBUSTIBLE;\r\n      document.getElementById(\"transmision\").value = data.TRANSMISION;\r\n      document.getElementById(\"precioDia\").value = data.PRECIO_DIA;\r\n      document.getElementById(\"disponible\").value = data.DISPONIBLE ? \"true\" : \"false\";\r\n      new bootstrap.Modal(document.getElementById(\"modalVehiculo\")).show();\r\n    }\r\n  }\r\n  \r\n  // Guardar un nuevo vehículo o actualizar uno existente\r\n  export async function guardarVehiculo() {\r\n    const campos = [\"marca\", \"modelo\", \"placa\", \"anio\", \"asientos\", \"combustible\", \"transmision\", \"precioDia\"];\r\n    for (let id of campos) {\r\n      const valor = document.getElementById(id).value.trim();\r\n      if (!valor) return mostrarToast(\"Todos los campos del vehículo son obligatorios.\", \"danger\");\r\n    }\r\n  \r\n    const vehiculo = {\r\n      MARCA: document.getElementById(\"marca\").value.trim(),\r\n      MODELO: document.getElementById(\"modelo\").value.trim(),\r\n      PLACA: document.getElementById(\"placa\").value.trim(),\r\n      AÑO: parseInt(document.getElementById(\"anio\").value),\r\n      ASIENTOS: parseInt(document.getElementById(\"asientos\").value),\r\n      COMBUSTIBLE: document.getElementById(\"combustible\").value.trim(),\r\n      TRANSMISION: document.getElementById(\"transmision\").value.trim(),\r\n      PRECIO_DIA: parseFloat(document.getElementById(\"precioDia\").value),\r\n      DISPONIBLE: document.getElementById(\"disponible\").value === \"true\",\r\n      updatedAt: new Date(),\r\n    };\r\n  \r\n    const id = document.getElementById(\"vehiculoId\").value;\r\n    try {\r\n      if (id) {\r\n        // Actualizar vehículo existente\r\n        await updateDoc(doc(db, \"vehiculos\", id), vehiculo);\r\n        mostrarToast(\"Vehículo actualizado correctamente.\", \"success\");\r\n      } else {\r\n        // Agregar nuevo vehículo\r\n        vehiculo.createdAt = new Date();\r\n        await addDoc(vehiculosRef, vehiculo);\r\n        mostrarToast(\"Vehículo agregado correctamente.\", \"success\");\r\n      }\r\n      bootstrap.Modal.getInstance(document.getElementById(\"modalVehiculo\")).hide();\r\n    } catch (error) {\r\n      mostrarToast(\"Error al guardar el vehículo.\", \"danger\");\r\n    }\r\n  }"]}