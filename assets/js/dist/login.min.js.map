{"version":3,"sources":["login.js"],"names":["_firebaseConfig","require","_firebaseFirestore","obtenerRol","uid","docRef","docSnap","data","regeneratorRuntime","async","_context","prev","next","doc","db","awrap","getDoc","sent","exists","abrupt","rol","stop","document","getElementById","addEventListener","email","password","userCredential","user","_context2","value","trim","signInWithEmailAndPassword","auth","console","log","alert","window","location","href","t0","error","message","result","_context3","signInWithPopup","googleProvider","_context4","_context5","microsoftProvider","event","_context6","preventDefault","createUserWithEmailAndPassword","setDoc","Date","t1"],"mappings":"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","file":"login.min.js","sourcesContent":["import { auth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signInWithPopup, googleProvider, githubProvider, microsoftProvider } from \"./firebaseConfig.js\";\r\nimport { db } from \"./firebaseConfig.js\";\r\nimport { doc, setDoc, getDoc } from \"https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js\";\r\n\r\n// Obtener el rol de un usuario\r\nasync function obtenerRol(uid) {\r\n    const docRef = doc(db, \"usuarios\", uid);\r\n    const docSnap = await getDoc(docRef);\r\n\r\n    if (docSnap.exists()) {\r\n        const data = docSnap.data();\r\n        return data.rol || null;\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n// Inicio de sesión con correo\r\ndocument.getElementById(\"btnLogin\").addEventListener(\"click\", async function () {\r\n    const email = document.getElementById(\"email\").value.trim();\r\n    const password = document.getElementById(\"password\").value.trim();\r\n\r\n    try {\r\n        const userCredential = await signInWithEmailAndPassword(auth, email, password);\r\n        const user = userCredential.user;\r\n        console.log(\"Usuario autenticado:\", user.email);\r\n\r\n        const rol = await obtenerRol(user.uid);\r\n        console.log(\"Rol:\", rol);\r\n\r\n        if (rol === \"admin\") {\r\n            alert(\"Bienvenido administrador\");\r\n            window.location.href = \"dashboardAdmin.html\"; // redirige al panel admin\r\n        } else if (rol === \"user\") {\r\n            alert(\"Inicio de sesión exitoso\");\r\n            window.location.href = \"index-2.html\";        } else {\r\n            }\r\n    } catch (error) {\r\n        console.error(\"Error en el inicio de sesión:\", error.message);\r\n        alert(\"Error: \" + error.message);\r\n    }\r\n});\r\n\r\n// Inicio de sesión con Google\r\ndocument.getElementById(\"btnGoogle\").addEventListener(\"click\", async function () {\r\n    try {\r\n        const result = await signInWithPopup(auth, googleProvider);\r\n        console.log(\"Usuario autenticado con Google:\", result.user);\r\n        alert(\"Inicio de sesión con Google exitoso\");\r\n        window.location.href = \"index-2.html\";\r\n    } catch (error) {\r\n        console.error(\"Error con Google:\", error.message);\r\n    }\r\n});\r\n\r\n// Inicio de sesión con GitHub\r\ndocument.getElementById(\"btnGitHub\").addEventListener(\"click\", async function () {\r\n    try {\r\n        const result = await signInWithPopup(auth, githubProvider);\r\n        console.log(\"Usuario autenticado con GitHub:\", result.user);\r\n        alert(\"Inicio de sesión con GitHub exitoso\");\r\n        window.location.href = \"index-2.html\";\r\n    } catch (error) {\r\n        console.error(\"Error con GitHub:\", error.message);\r\n    }\r\n});\r\n\r\n// Inicio de sesión con Microsoft\r\ndocument.getElementById(\"btnMicrosoft\").addEventListener(\"click\", async function () {\r\n    try {\r\n        const result = await signInWithPopup(auth, microsoftProvider);\r\n        console.log(\"Usuario autenticado con Microsoft:\", result.user);\r\n        alert(\"Inicio de sesión con Microsoft exitoso\");\r\n        window.location.href = \"index-2.html\";\r\n    } catch (error) {\r\n        console.error(\"Error con Microsoft:\", error.message);\r\n    }\r\n});\r\n\r\n// Registro de usuario con correo\r\ndocument.getElementById(\"registerEmail\").addEventListener(\"click\", async (event) => {\r\n    event.preventDefault();\r\n\r\n    const email = document.getElementById(\"email\").value.trim();\r\n    const password = document.getElementById(\"password\").value.trim();\r\n\r\n    if (email === \"\" || password === \"\") {\r\n        alert(\"Por favor, ingresa un correo y una contraseña.\");\r\n        return;\r\n    }\r\n\r\n    try {\r\n        const userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n        const user = userCredential.user;\r\n\r\n        // Guardar rol en Firestore\r\n        try {\r\n            await setDoc(doc(db, \"usuarios\", user.uid), {\r\n              email: user.email,\r\n              rol: \"user\",\r\n              uid: user.uid,\r\n              createdAt: new Date()\r\n            });\r\n        \r\n            console.log(\"Usuario guardado correctamente en Firestore\");\r\n        \r\n          } catch (error) {\r\n            console.error(\"Error al guardar en Firestore:\", error.message);\r\n          }\r\n        \r\n          alert(\"Registro exitoso. Bienvenido, \" + user.email);\r\n        } catch (error) {\r\n          console.error(\"Error en el registro:\", error.message);\r\n          alert(\"Error: \" + error.message);\r\n        }\r\n\r\n\r\n\r\n        \r\n});\r\n"]}